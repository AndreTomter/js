<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<script>
		window.top.postMessage(
		  {
		    subject: 'lti.frameResize',
		    height: 800
		  },
		  '*')
	</script>
<style>
	.tableFixHead 
		{
        	overflow-y: scroll;
        	height: 400px !important;
      		}
	
	.tableFixHead thead th 
		{
        	position: sticky !important;
        	top: 0 !important;
      		}
	
      	table 
		{
        	border-collapse: collapse;
        	width: 100%;
		height: 400px
      		}


	::-webkit-scrollbar-thumb 							/* scrollbar Handle */
		{
    		background: #640000;  							/* fallback for old browsers */
    		background: -webkit-linear-gradient(to right, #aa0000, #640000);  	/* Chrome 10-25, Safari 5.1-6 */
    		background: linear-gradient(to right, #aa0000, #640000); 		/* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
		border-radius: 4px;
    		}
	
	::-webkit-scrollbar-track 							/* scrollbar Track */
		{
	    	background: #C9D6FF;  							/* fallback for old browsers */
	    	background: -webkit-linear-gradient(to right, #E2E2E2, #C9D6FF);  	/* Chrome 10-25, Safari 5.1-6 */
	    	background: linear-gradient(to right, #E2E2E2, #C9D6FF);		/* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    		border-radius: 4px;
		}
	
	/* scrollbar width */
	::-webkit-scrollbar 
		{
  		width: 4px;
		}

	div
		{
		height: auto;
		}
	
	table tr 
		{
  		border-bottom: 1px solid #d5d5d5;
		}

	table tr:last-child 
		{
  		border: 0 !important;
		}
	
	select
		{
		font-family: Arial, Helvetica, sans-serif;
		background-color: #DB3F3D;
		color: #ffffff !important;
		padding: 10px;
		font-size: 14px;
		border: none;
		cursor: pointer;
		}

	option
		{
		font-family: Arial, Helvetica, sans-serif;
		background-color: #fff;
		color: #333333 ;
		padding: 12px;
		font-size: 14px;
		border: none;
		cursor: pointer;
		}

	.emner a
		{
		color:#0075af;
		}
	
	.emner p
		{
		color: #333333;
    
		}

	#filter
		{
		font-family: Arial, Helvetica, sans-serif;
		color: #333333;
		padding: 12px;
		font-size: 14px;
		border: none;
		cursor: pointer;
		}
	
	.emner table
		{
		height: auto;
		border-collapse: collapse;
    		width: 100%;
		}

	.emner	
		{
		  font-family: Arial, Helvetica, sans-serif;
		  border-collapse: collapse;
		}
		
	.emner td, .emner th, .emner tr
		{
	 	border: 1px collapse #ddd;
    		padding-left: 20px !important;
    		padding-right: 20px !important;
	  	padding: 8px;
     		border-collapse: collapse;
		font-size: 12px;
		}

	.emner tr:hover 
		{
		background-color: #ddd;
		}

	.emner th 	
		{
		 padding-top: 9px;
		 padding-bottom: 8px;
		 text-align: left;
		 background-color: #DB3F3D;	
		 color: white;
		 font-size: 14px;
		}
	.emner table td + td + td 
		{
  		text-align: left;
		}
	.emner table th + th + th 
		{
  		text-align: right;
		}
</style>

	
		
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script> 
	<script>
     	var semdato = new Date();
	var dd = String(semdato.getDate()).padStart(2, '0');
	var mm = String(semdato.getMonth() + 1).padStart(2, '0'); //January is 0!
	var yyyy = semdato.getFullYear();

		if (dd >= 15 	&&	mm	== 	12) 	{ semester = yyyy+1	+	"V";}
		if (			mm	< 	06) 	{ semester = yyyy	+	"V";}
		if (dd <  15 	&& 	mm 	== 	06) 	{ semester = yyyy	+	"V";}
		if (dd >= 15 	&&	mm 	== 	06) 	{ semester = yyyy	+	"H";}
		if (			mm	> 	06) 	{ semester = yyyy	+	"H";}
		
		if (dd >= 15 	&&	mm	== 	12) 	{ semestertekst = "våren " + yyyy+1	;}
		if (			mm	< 	06) 	{ semestertekst = "våren " + yyyy	;}
		if (dd <  15 	&& 	mm 	== 	06) 	{ semestertekst = "våren " + yyyy	;}
		if (dd >= 15 	&&	mm 	== 	06) 	{ semestertekst = "høsten " + yyyy	;}
		if (			mm	> 	06) 	{ semestertekst = "høsten " + yyyy	;}
	
		
		
	//fakultet som skal vises
	const fakultet = ['15']

	// api url
	const api_url = "https://fs.data.uib.no/KEYuxumaqu6u/json/littl_emne/"	+	semester;

	// Defining async function
	async function getapi(url)	{

	// Storing response
	const response = await fetch(url);

	// Storing data in form of JSON
	const data = await response.json();
  	
	// filtrerer listen	
	const emne = data.emne.filter( i => fakultet.includes( i.faknr_reglement ) );
  	
	//sorterer alfabetisk
	const sortert = emne.sort( function( a, b )
  	 			{
                                  a = a.instituttnr_reglement.concat(a.emnekode.toLowerCase());
                                  b = b.instituttnr_reglement.concat(b.emnekode.toLowerCase());
                                  return a < b ? -1 : a > b ? 1 : 0;
	                        });
   
	console.log(sortert)
   
   	show(sortert)
   
  					}
  	
	getapi(api_url)
  
  	function show(sortert) {
		let tab =
			`<thead stype="color: #FFFFFF"><tr data-port="stay" style="hight:20px">
				<th>Emnekode</th>
				<th>Emnenavn</th>
				<th>Studiepoeng</th>
			</tr></thead>`;
	
		// Loop to access all rows
		for (let r of sortert) {
        	tab += `<tr class="emner" data-port="${r.faknr_reglement}${r.instituttnr_reglement}"> 
				<td ><a href="https://www.uib.no/emne/${r.emnekode}"  target="_blank" rel="noopener noreferrer">${r.emnekode}</a></td>   
				<td >${r.emnenavn_bokmal}</td>   
   				<td style="text-align: right;">${r.studiepoeng} sp</td>   
			</tr>`;
					}
	
	// Setting innerHTML as tab variable
	document.getElementById("emner").innerHTML = tab;
	document.getElementById("semestertekst").innerHTML = semestertekst;
				}
	document.addEventListener('DOMContentLoaded', function () {
    		let table = new DataTable('#example');
								});
	
  	table = document.getElementById("emner");	
	
	</script>
		
</head>
<body>
	<h1>Emner med undervisning <span id="semestertekst"></span></h1>
	
		<p style="text-align: right;">
		<select id="filter" class="emner" stye="background-color: #DB3F3D">	  
  			<option class="emner" value="valg" style="color: #ffffff; font: bold"; hidden selected>Velg institutt</option>
			<option class="emner" value="1511">Sosiologisk institutt</option>
			<option class="emner" value="1512">Institutt for politikk og forvaltning</option>
			<option class="emner" value="1513">Institutt for sammenliknende politikk</option>
			<option class="emner" value="1515">Institutt for økonomi</option>
			<option class="emner" value="1517">Institutt for informasjons- og medievitenskap</option>
			<option class="emner" value="1534">Institutt for sosialantropologi</option>
			<option class="emner" value="1541">Institutt for geografi</option>
		</select>
		</p>
		<script>
		
    $('#filter').change(function() {
			var port = $(this).val()
			console.log( port )
			if ( port !== '' ) {
				$("tr[data-port!=" + port+ "]").css('visibility', 'collapse');
				$("tr[data-port=" + port+ "]").css('visibility', 'visible');
				$("tr[data-port=stay]").css('visibility', 'visible');
			} else {
				$("tr").css('visibility', 'visible');
			}
		});
    </script>

	<div class="tableFixHead">
		<table id="emner" class="emner"></table>
 	</div>
	<p> Endrer semester 15 desember og 15 juni </p>
</body>
</html>
